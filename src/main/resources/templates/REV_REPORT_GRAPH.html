<!DOCTYPE html>
<html lang="en" xmlns:th="www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description"
		content="Responsive sidebar template with sliding effect and dropdown menu based on bootstrap 3">
	<title>iConverge</title>
	<!-- using online links -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
		integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
		integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
	<link rel="stylesheet" href="//malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css">
	<!-- CSS only -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
	<!-- CSS only -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
	<link rel="stylesheet" href="../css/main.css">
	<link rel="stylesheet" href="../css/sidebar-themes.css">
	<link rel="stylesheet" href="../css/form-style.css">
	<link rel="stylesheet" href="../css/index.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
	<!-- datatable link  -->
	<link href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css" rel="stylesheet" />
	<style type="text/css"></style>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<body>
	<div class="page-wrapper default-theme  bg1 toggled">
		<span th:remove="tag" th:utext="${dataHtml}"></span>
		<!-- page-content  -->
		<main class="page-content">
			<div id="overlay" class="overlay"></div>
			<div class="container-fluid" style="padding: 0px;">
				<div class="title-bar"
					style="height: 90px; background-image: url(../img/bn.jpeg) !important; background-repeat: no-repeat; width: 100%; height: 100%; background-size: cover;">
					<a id="toggle-sidebar" class="btn btn-secondary rounded-0" href="#"
						style="margin: 20px; background: #3ab54a;">
						<span>
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
								class="bi bi-list" viewBox="0 0 16 16">
								<path fill-rule="evenodd"
									d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
							</svg>
						</span>
					</a>
				</div>
				<div class="container">
					<form th:action="@{/IC_REV_REPORT_GRAPH}" method="post" th:object="${xyz}">
						<div class="row">
							<div class="col-lg-4 col-md-4 col-sm-12">
								<div class="row">
									<div class="col-lg-3 col-md-3 col-sm-12">
										<label for="text" class="text-center m-2">Zone:</label>
									</div>
									<div class="col-lg-9 col-md-9 col-sm-12">
										<select id="zone" class="form-control" name="zone" required>
											<option value="">Select Zone</option>
											<option th:each="zone : ${listIC_ZONE_MST}" th:value="${zone.ZONE_CODE}"
												th:text="${zone.ZONE_NAME}"
												th:selected="(${zone.ZONE_CODE} == ${xyz.zone})"></option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-lg-4 col-md-4 col-sm-12">
								<div class="row">
									<div class="col-lg-3 col-md-3 col-sm-12">
										<label for="text" class="text-center m-2">Circle:</label>
									</div>
									<div class="col-lg-9 col-md-9 col-sm-12">
										<select id="circle" class="form-control" name="circle">
											<option value="">Select Circle</option>
											<option th:each="circle : ${circleList}" th:value="${circle.CIRCLE_CODE}"
												th:text="${circle.CIRCLE_NAME}"
												th:selected="${circle.CIRCLE_CODE}==*{circle}"></option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-lg-4 col-md-4 col-sm-12">
								<div class="row">
									<div class="col-lg-3 col-md-3 col-sm-12">
										<label for="text" class="text-center m-2">Loc/Esu:</label>
									</div>
									<div class="col-lg-9 col-md-9 col-sm-12">
										<select id="loc" class="form-control" name="loc">
											<option value="">Select Location</option>
											<option th:each="l : ${locList}" th:value="${l.LOCATION_CODE}"
												th:text="${l.LOCATION_NAME}"
												th:selected="(${l.LOCATION_CODE} == *{loc})"></option>
										</select>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							
							<div class="col-lg-4 col-md-4 col-sm-12">
							   <div class="row">
							      <div class="col-lg-3 col-md-3 col-sm-12">
							         <label for="text" class="text-center m-2">Report Level:</label>
							      </div>
							      <div class="col-lg-9 col-md-9 col-sm-12">
							         <select id="report" class="form-control" name="report" required>
							            <option value="">Select Report</option>
							            <option th:each="r : ${listIC_REPORT_LEVEL_MST}" th:value="${r.REPORT_LEVEL_CODE}" th:text="${r.REPORT_LEVEL_DESC}" th:selected="${r.REPORT_LEVEL_CODE}==*{report}" ></option>
							         </select>
							      </div>
							   </div>
							</div>
							
							<div class="col-lg-4 col-md-4 col-sm-12">
								<div class="row">
									<div class="col-lg-3 col-md-3 col-sm-12 mt-3 text-center">
										<label for="bill" class="">Month :</label>
									</div>
									<div class="col-lg-9 col-md-9 col-sm-12">
										<select id="bill" class="form-control" name="bill" required>
											<option value="">Select Month</option>
											<option th:each="b : ${billList}" th:value="${b.BILL_CYCLE_CODE}"
												th:text="${b.BILL_CYCLE_DESC}"
												th:selected="${b.BILL_CYCLE_CODE}==*{bill}"></option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-lg-4 col-md-4 col-sm-12 text-center">
								<input type="submit" value="Load" class="btn btn-lg btn-success mr-1 mb-1" /> <input
									type='button' id='btn' value='Print' class="btn btn-lg btn-primary mr-1 mb-1 "
									onclick="printContent('divName')">
							</div>
						</div>
					</form>
				</div>
				<!-- 4th page start  -->
				<div id="divName" class="container mt-5">
					<div class="row">
						<p>
							<h4 style="color: white;text-align:center;text-decoration: underline; background-color: #1fa4c3;padding: 10px;">Distribution System Loss 
								in Comparison <span th:text="${REPORT_LEVEL}"></span>: <span th:text="${REPORT_LEVEL1}"></span>
							</h4>
						</p>
					</div>

					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12">
							<!--      chart start (R) -->
							<div class="row" style="">

								<!-- 1st chart start -->
								<div class="col-lg-10 col-md-10 col-sm-12 fig1 m-0"
									style="height: 550px; border-radius: 10px; margin: 0 auto;">
									<div id="chart_div" style="height: 400px; border-radius: 10px; margin: 0 auto;">
									</div>
									<div id="chart_div_empty"
										style="height: 150px; border-radius: 10px; margin: 0 auto;">
									</div>
								</div>
								
								<!-- 1st chart end -->
							</div>
						</div>
					</div>
					
					
					<div class="row">
						
						<div class="card-body" style="Width: 90%">
							<div class="card-header" style="background: #abcdef; border: 1px solid #0a0a0a;">
								<h4 class="card-title" style="text-align: center;">Month
									Wise Distribution System Loss
								</h4>
							</div>
							<div class="table-responsive">
								<table class="table display table-bordered margin-top:10px">
									<thead class="text text-center" style="font-size: 14px; color: black;">
										<tr style="border: 1px solid #0a0a0a;">
											<th style="border: 1px solid #0a0a0a;">Month</th>
											<th style="border: 1px solid #0a0a0a;">Sys. Loss (%)</th>
										</tr>
									</thead>
									<tbody class="text text-center">
										<tr style="border: 1px solid #0a0a0a;"
											th:each="s: ${listDPD_REV_REPORT_GRAPH_MON}">
											<td style="border: 1px solid #0a0a0a;" th:text="${s.MONTH_DESC}"></td>
											<td style="border: 1px solid #0a0a0a;" th:text="${s.DIST_SYS_LOSS}"></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
					
					
					<div class="container mt-4">
						<!-- <p style="text-align: center; text-decoration: underline;">
							BPDB Distribution System Loss (%) [
							<span
					          th:text="${LAST_MON}"></span>
					      - <span 
					         th:text="${CURR_MON}"></span>  ]
						</p> -->
						<div class="row">
							<div class="col-lg-12 col-md-12 col-sm-12">
								<!-- <canvas id="myChart" style=" max-width: 1300px; max-height: 500px;"></canvas> -->
								<div class="row">
									
									<div class="col-lg-10 col-md-10 col-sm-12 " id="chart_div2">
									</div>
									
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<p style="text-align: center; text-decoration: underline;">
							<h4 style="color: white;text-align:center;text-decoration: underline; background-color: #1fa4c3;padding: 10px;">C/I Ratio
								in Comparison <span th:text="${REPORT_LEVEL}"></span>: <span th:text="${REPORT_LEVEL1}"></span>
							</h4>
						</p>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12">
							<!--      chart start (R) -->
							<div class="row" style="">

								<!-- 1st chart start -->
								<div class="col-lg-10 col-md-10 col-sm-12 fig1 m-0"
									style="height: 550px; border-radius: 10px; margin: 0 auto;">
									<div id="chart_div1" style="height: 400px; border-radius: 10px; margin: 0 auto;">
									</div>
									<div id="chart_div_empty"
										style="height: 150px; border-radius: 10px; margin: 0 auto;">
									</div>
								</div>
								
								<!-- 1st chart end -->
							</div>
						</div>
					</div>
					
					<div class="row">						
						<div class="card-body" style="Width: 90%">
							<div class="card-header" style="background: #abcdef; border: 1px solid #0a0a0a;">
								<h4 class="card-title" style="text-align: center;">Month
									Wise C/I Ratio
								</h4>
							</div>
							<div class="table-responsive">
								<table class="table display table-bordered margin-top:10px">
									<thead class="text text-center" style="font-size: 14px; color: black;">
										<tr style="border: 1px solid #0a0a0a;">
											<th style="border: 1px solid #0a0a0a;">Month</th>
											<th style="border: 1px solid #0a0a0a;">C/I Ratio (%)</th>
										</tr>
									</thead>
									<tbody class="text text-center">
										<tr style="border: 1px solid #0a0a0a;"
											th:each="s: ${listDPD_REV_REPORT_GRAPH_MON}">
											<td style="border: 1px solid #0a0a0a;" th:text="${s.MONTH_DESC}"></td>
											<td style="border: 1px solid #0a0a0a;" th:text="${s.CI_RATIO}"></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<div class="container mt-4">
						<!-- <p style="text-align: center; text-decoration: underline;">
							BPDB C/I Ratio (%)[ 
							<span
					          th:text="${LAST_MON}"></span>
					      <span>-</span> <span 
					         th:text="${CURR_MON}"></span>]
						</p> -->
						<div class="row">
							<div class="col-lg-12 col-md-12 col-sm-12">
								<!-- <canvas id="myChart" style=" max-width: 1300px; max-height: 500px;"></canvas> -->
								<div class="row">		

									<div class="col-lg-10 col-md-10 col-sm-12 " id="chart_div3"></div>
									
								</div>
							</div>
						</div>
					</div>

				</div>
			</div>
		</main>
		<!-- page-content" -->
	</div>
	<!-- page-wrapper -->
	<!-- using online scripts -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
		integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
		integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
		crossorigin="anonymous"></script>
	<script src="//malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
	<script src="../js/main.js"></script>
	<script src="../js/script.min.js"></script>
	<!-- datatable script  -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script th:inline="javascript">
		function mt_rand(min, max) {
			var argc = arguments.length
			if (argc === 0) {
				min = 0
				max = 2147483647
			} else if (argc === 1) {
				throw new Error(
					'Warning: mt_rand() expects exactly 2 parameters, 1 given')
			}
			return Math.floor(Math.random() * (max - min + 1)) + min
		}
		function random_color_part() {

			return mt_rand(0, 255);
		}

		function random_color() {
			return 'rgb(' + random_color_part() + ',' + random_color_part()
				+ ',' + random_color_part() + ')';
		}

		var real_data = /*[[${chartData}]]*/'noValue';

		let x = [];
		for (var property in real_data) {
			x.push(property);

		}

		$(document).ready(function () {
			google.charts.load('current', {
				packages: ['corechart', 'bar']
			});
			google.charts.setOnLoadCallback(drawColumnChart);

		});

		function drawColumnChart() {
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Feeder');
			data.addColumn('number', 'Fiscal Year Wise Distribution System Loss');
			data.addColumn({
				type: 'string',
				role: 'style'
			});
			data.addColumn({
				type: 'number',
				role: 'annotation'
			});
			Object.keys(real_data).forEach(
				function (key) {
					data.addRow([key, real_data[key], random_color(),
						real_data[key]]);

				});
			var options = {
				title: '',
				legend: {
					position: 'top',
					maxLines: 3
				},
				hAxis: {
					title: '',

				},
				vAxis: {
					title: 'Fiscal Year Wise Distribution System Loss'
				},
				width: 1000,
				height: 500,
			};
			var chart = new google.visualization.ColumnChart(document
				.getElementById('chart_div'));
			chart.draw(data, options);

			google.visualization.events.addListener(chart, 'select',
				selectHandler);
			function selectHandler(e) {
				alert(data.getValue(chart.getSelection()[0].row, 0));
			}
		}



		var real_data1 = /*[[${chartData1}]]*/'noValue';

		let x1 = [];
		for (var property in real_data1) {
			x1.push(property);

		}

		$(document).ready(function () {
			google.charts.load('current', {
				packages: ['corechart', 'bar']
			});
			google.charts.setOnLoadCallback(drawColumnChart1);

		});

		function drawColumnChart1() {
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Feeder');
			data.addColumn('number', 'Fiscal Year Wise C/I Ratio');
			data.addColumn({
				type: 'string',
				role: 'style'
			});
			data.addColumn({
				type: 'number',
				role: 'annotation'
			});
			Object.keys(real_data1).forEach(
				function (key) {
					data.addRow([key, real_data1[key], random_color(),
						real_data1[key]]);

				});
			var options = {
				title: '',
				legend: {
					position: 'top',
					maxLines: 3
				},
				hAxis: {
					title: '',

				},
				vAxis: {
					title: 'Fiscal Year Wise C/I Ratio'
				},
				width: 1000,
				height: 500,
			};
			var chart = new google.visualization.ColumnChart(document
				.getElementById('chart_div1'));
			chart.draw(data, options);

			google.visualization.events.addListener(chart, 'select',
				selectHandler);
			function selectHandler(e) {
				alert(data.getValue(chart.getSelection()[0].row, 0));
			}
		}











		var real_data2 = /*[[${chartData2}]]*/'noValue';

		$(document).ready(function () {
			google.charts.load('current', {
				packages: ['corechart', 'line']
			});
			google.charts.setOnLoadCallback(drawColumnChart2);

		});

		function drawColumnChart2() {
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Feeder');
			data.addColumn('number', 'Month Wise Distribution System Loss');
			data.addColumn({
				type: 'string',
				role: 'style'
			});
			data.addColumn({
				type: 'number',
				role: 'annotation'
			});
			Object.keys(real_data2).forEach(
				function (key) {
					data.addRow([key, real_data2[key], random_color(),
						real_data2[key]]);

				});

			var options = {
				title: '',
				legend: {
					position: 'top',
					maxLines: 5
				},
				hAxis: {
					title: '',
				},
				vAxis: {
					title: 'Month Wise Distribution System Loss'
				},

				width: 1000,
				height: 500,

			};

			var chart = new google.visualization.LineChart(document
				.getElementById('chart_div2'));
			chart.draw(data, options);

			google.visualization.events.addListener(chart, 'select',
				selectHandler);
			function selectHandler(e) {
				alert(data.getValue(chart.getSelection()[0].row, 0));
			}
		}




		var real_data3 = /*[[${chartData3}]]*/'noValue';

		$(document).ready(function () {
			google.charts.load('current', {
				packages: ['corechart', 'line']
			});
			google.charts.setOnLoadCallback(drawColumnChart3);

		});

		function drawColumnChart3() {
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Feeder');
			data.addColumn('number', 'Month Wise C/I Ratio');
			data.addColumn({
				type: 'string',
				role: 'style'
			});
			data.addColumn({
				type: 'number',
				role: 'annotation'
			});
			Object.keys(real_data3).forEach(
				function (key) {
					data.addRow([key, real_data3[key], random_color(),
						real_data3[key]]);

				});

			var options = {
				title: '',
				legend: {
					position: 'top',
					maxLines: 5
				},
				hAxis: {
					title: '',
				},
				vAxis: {
					title: 'Month Wise C/I Ratio'
				},

				width: 1000,
				height: 500,

			};

			var chart = new google.visualization.LineChart(document
				.getElementById('chart_div3'));
			chart.draw(data, options);

			google.visualization.events.addListener(chart, 'select',
				selectHandler);
			function selectHandler(e) {
				alert(data.getValue(chart.getSelection()[0].row, 0));
			}
		}

	</script>
	<script type="text/javascript">
		function printContent(el) {

			var divToPrint = document.getElementById(el);

			var newWin = window.open('', 'Print-Window');

			newWin.document.open();

			newWin.document
				.write('<html> <link rel="stylesheet"href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"crossorigin="anonymous">');
			newWin.document
				.write('<style> @media print {.pagebreak { page-break-before: always; }}  *{font-size: 9px;} table, th, td {border: 1px solid black;} .table{border: 2px solid black;border-collapse: collapse;width: 100%;} </style>');
			newWin.document.write('<body onload="window.print()"> ');

			newWin.document.write(divToPrint.innerHTML);

			newWin.document.write('</body></html>');

			newWin.document.close();

			setTimeout(function () {
				newWin.close();
			}, 1000);
		}
	</script>
	<!-- 		circle dropdown starts  -->
	<script>
		$(document).ready(
			function () {
				$("#zone")
					.change(
						function () {

							$("#circle").empty();

							var x = $("#zone").val();

							if (x == "") {
								$("#circle").empty();
								$("<option>")
									.val("")
									.text(
										"Select Circle")
									.appendTo(
										circleDropdown);
							} else {

								var urlString = "/api/circle/"
									+ x;
								console.log(urlString);

								$
									.ajax({
										method: "GET",
										url: urlString
									})
									.done(
										function (
											responseJson) {

											circleDropdown = $("#circle");

											$(
												"<option>")
												.val(
													"")
												.text(
													"Select Circle")
												.appendTo(
													circleDropdown);
											$
												.each(
													responseJson,
													function (
														index,
														circle) {

														$(
															"<option>")
															.val(
																circle.circle_CODE)
															.text(
																circle.circle_NAME)
															.appendTo(
																circleDropdown);
													});
										})
									.fail(
										function () {
											alert("Connection Error");
										})
							}

						})
			})

	</script>
	<!-- 		circle dropdown ends  -->


	<!-- 		loc dropdown starts depending on zone code   -->
	<script>
		$(document).ready(function () {
			$("#zone").change(function () {

				$("#loc").empty();



				var x = $("#zone").val();

				if (x == "") {
					$("#loc").empty();
					$("<option>").val("").text("Select Location").appendTo(locDropdown);
				}
				else {

					var urlString = "/api/location/" + x;
					console.log(urlString);

					$.ajax({
						method: "GET",
						url: urlString
					})
						.done(function (responseJson) {

							locDropdown = $("#loc");

							$("<option>").val("").text("Select Location").appendTo(locDropdown);
							$.each(responseJson, function (index, loc) {

								$("<option>").val(loc.location_CODE).text(loc.location_NAME).appendTo(locDropdown);
							});
						})
						.fail(function () {
							alert("Connection Error");
						})
				}


			})
		})
	</script>
	<!-- 		loc dropdown ends depending on zone code -->


	<!-- 			loc dropdown starts depending on circle code-->
	<script>
		$(document).ready(function () {
			$("#circle").change(function () {

				$("#loc").empty();



				var x = $("#zone").val();
				var y = $("#circle").val();
				// 					console.log(x);

				if (x == "") {
					$("#loc").empty();
					$("<option>").val("").text("Select Location").appendTo(locDropdown);
				}
				else {



					var urlString = "/api/location/" + x + "/" + y;
					console.log(urlString);

					$.ajax({
						method: "GET",
						url: urlString
					})
						.done(function (responseJson) {

							locDropdown = $("#loc");

							// 							alert(responseJson);

							$("<option>").val("").text("Select Location").appendTo(locDropdown);
							$.each(responseJson, function (index, loc) {
								// 								

								$("<option>").val(loc.location_CODE).text(loc.location_NAME).appendTo(locDropdown);
							});
						})
						.fail(function () {
							alert("Connection Error");
						})
				}


			})
		})
	</script>
	<!-- 	loc dropdown ends depending on circle code-->




</body>

</html>